html_text() %>%
trim()
lis2 <- ifelse(lis2 %in% c("","동영상기사"),"",lis2)
lis.titles <- c(lis1,lis2)
titles <- c()
for (i in 1:length(lis.titles)) {
if (lis.titles[i] %in% c("","동영상기사")) {
titles <- titles }
else {
a <- gsub('\\"',"",lis.titles[i])
titles <- c(titles,a)
}
}
# 제공회사
lis3 <- html %>%
html_node('#main_content') %>%
html_node('.type06_headline') %>%
html_nodes('.writing') %>%
html_text()
lis4 <- html %>%
html_node('#main_content') %>%
html_node('.type06') %>%
html_nodes('.writing') %>%
html_text()
writing <- c(lis3,lis4)
# 기사
lis5 <- html %>%
html_node('#main_content') %>%
html_node('.type06_headline') %>%
html_nodes('.lede') %>%
html_text() %>%
trim()
lis5 <- ifelse(lis5 %in% c("","동영상기사"),"",lis5)
lis6 <- html %>%
html_node('#main_content') %>%
html_node('.type06') %>%
html_nodes('.lede') %>%
html_text() %>%
trim()
lis6 <- ifelse(lis6 %in% c("","동영상기사"),"",lis6)
lis.articles <- c(lis5,lis6)
articles <- c()
for (i in 1:length(lis.articles)) {
if (lis.articles[i] %in% c("","동영상기사")) {
articles <- articles }
else {
a <- gsub('\\"',"",lis.articles[i])
articles <- c(articles,a)
}
}
headline <- data.frame(titles=titles, writing=writing, articles=articles)
naver_headline <- rbind.data.frame(naver_headline, headline)
#  addWorksheet(wb, categories[i])
#  writeDataTable(wb, categories[i], naver_headline)
}
naver_headline <- cbind.data.frame(category,naver_headline)
View(naver_headline)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>% html_node('iframe.ifr') %>% html_attr('src')
url_add <- "&page="
url_ifr <- paste0(base_url,url2,url_add)
pages <- 1:5
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,pages[n])
html2 <- read_html(url_pages)
lis <- html2 %>% html_node('div.score_result') %>% html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,html_node(li,'.star_score') %>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple') %>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
View(naver_movie)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>% html_node('iframe.ifr') %>% html_attr('src')
url_add <- "&page="
url_ifr <- paste0(base_url,url2,url_add)
pages <- 1:2918
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,pages[n])
html2 <- read_html(url_pages)
lis <- html2 %>% html_node('div.score_result') %>% html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,html_node(li,'.star_score') %>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple') %>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
View(naver_movie)
write.csv(naver_movie,"naver_movie.csv")
setwd("D:/Workplace/R_Project/project1_naver_headline")
library(rvest)
library(dplyr)
library(stringr)
library(openxlsx)
library(abind)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
### Naver news 속보 top 20
categories <- c("정치","경제","사회","생활_문화","세계","IT_과학","오피니언")
base_url <- 'https://news.naver.com/main/list.nhn?mode=LSD&mid=sec&sid1='
number <- c(100,101,102,103,104,105,110)
# wb <- createWorkbook()
category <- c()
for (i in 1:length(categories)) {
category <- c(category,rep(categories[i],20))
}
naver_headline <- data.frame(titles=c(), writing=c(), articles=c())
for (i in 1:length(number)) {
url <- paste0(base_url,number[i])
html <- read_html(url)
# 제목
lis1 <- html %>%
html_node('#main_content') %>%
html_node('.type06_headline') %>%
html_nodes('dt') %>%
html_text() %>%
trim()
lis1 <- ifelse(lis1 %in% c("","동영상기사"),"",lis1)
lis2 <- html %>%
html_node('#main_content') %>%
html_node('.type06') %>%
html_nodes('dt') %>%
html_text() %>%
trim()
lis2 <- ifelse(lis2 %in% c("","동영상기사"),"",lis2)
lis.titles <- c(lis1,lis2)
titles <- c()
for (i in 1:length(lis.titles)) {
if (lis.titles[i] %in% c("","동영상기사")) {
titles <- titles }
else {
a <- gsub('\\"',"",lis.titles[i])
titles <- c(titles,a)
}
}
# 제공회사
lis3 <- html %>%
html_node('#main_content') %>%
html_node('.type06_headline') %>%
html_nodes('.writing') %>%
html_text()
lis4 <- html %>%
html_node('#main_content') %>%
html_node('.type06') %>%
html_nodes('.writing') %>%
html_text()
writing <- c(lis3,lis4)
# 기사
lis5 <- html %>%
html_node('#main_content') %>%
html_node('.type06_headline') %>%
html_nodes('.lede') %>%
html_text() %>%
trim()
lis5 <- ifelse(lis5 %in% c("","동영상기사"),"",lis5)
lis6 <- html %>%
html_node('#main_content') %>%
html_node('.type06') %>%
html_nodes('.lede') %>%
html_text() %>%
trim()
lis6 <- ifelse(lis6 %in% c("","동영상기사"),"",lis6)
lis.articles <- c(lis5,lis6)
articles <- c()
for (i in 1:length(lis.articles)) {
if (lis.articles[i] %in% c("","동영상기사")) {
articles <- articles }
else {
a <- gsub('\\"',"",lis.articles[i])
articles <- c(articles,a)
}
}
headline <- data.frame(titles=titles, writing=writing, articles=articles)
naver_headline <- rbind.data.frame(naver_headline, headline)
#  addWorksheet(wb, categories[i])
#  writeDataTable(wb, categories[i], naver_headline)
}
# saveWorkbook(wb, file="D:/Workplace/R_Project/project1_naver_headline/naver_headline_top20.xlsx")
naver_headline <- cbind.data.frame(category,naver_headline)
View(naver_headline)
write.csv(naver_headline,"naver_headline.csv")
setwd("D:/Workplace/R_Project/project3_daum_ranking")
url <- "https://media.daum.net/ranking/popular/"
html <- read_html(url)
html %>% html_node(".list_news2")
rank <- html %>% html_node(".list_news2") %>% html_node(".num_rank")
rank
rank <- html %>% html_node(".list_news2") %>% html_node(".num_rank") %>% trim()
rank
rank <- html %>% html_node(".list_news2") %>% html_node(".screen_out")
rank
rank <- html %>% html_node(".list_news2") %>% html_node(".num_news num1")
rank
html %>% html_node(".list_news2") %>% html_node(".screen_out")
html %>% html_node(".list_news2")
html %>% html_node(".list_news2") %>% trim()
html %>% html_node(".list_news2")
html %>%
html_node(".list_news2") %>%
html_node(".rank_num rank_popular")
html %>%
html_node(".list_news2") %>%
html_node(".num_rank")
rank <- html %>%
html_node(".list_news2") %>%
html_node(".num_rank")
rank[2]
rank <- html %>%
html_node(".list_news2") %>%
html_node(".num_rank") %>% trim()
rank
lis <- html %>%
html_node(".list_news2") %>%
html_text("li")
lis
lis <- html %>%
html_node(".list_news2") %>%
html_text("li") %>% trim()
lis
rank <- html %>%
html_node(".list_news2") %>%
html_text("li") %>% trim() %>% str_sub(1,1)
rank
titles <- html %>%
html_node("strong.tit_thumb")
titles
titles <- html %>%
html_node("strong.tit_thumb") %>% html_text('a')
titles
titles <- html %>%
html_node("strong.tit_thumb") %>% html_node(".link_txt")
titles
titles <- html %>%
html_node("strong.tit_thumb") %>% html_text("a")
titles
titles <- html %>%
html_node("strong.tit_thumb") %>% html_node("a.link_txt")
titles
titles <- html %>%
html_node("strong.tit_thumb")
titles
titles <- html %>%
html_node("strong.tit_thumb") %>% html_text()
titles
idx <- str_locate(titles,"\n")
idx
titles <- html %>%
html_node("strong.tit_thumb") %>% html_text() %>% trim()
titles
idx <- str_locate(titles,"\n")
idx
titles <- str_sub(titles,1,idx[1]-1)
titles
tmp <- html %>%
html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
titles <- str_sub(tmp,1,idx[1]-1)
tmp <- html %>%
html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
titles <- str_sub(tmp,1,idx[1]-1)
tmp <- trim(str_sub(tmp,idx[1],-1))
tmp
rank
titles
writer
tmp <- trim(str_sub(tmp,idx[1],-1))
writer <- tmp
writer
rank <- html %>%
html_node(".list_news2") %>%
html_text("li") %>% trim() %>% str_sub(1,1)
tmp <- html %>%
html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
titles <- str_sub(tmp,1,idx[1]-1)
tmp <- trim(str_sub(tmp,idx[1],-1))
rank
titles
tmp
writer <- tmp
writer
html
url
html %>%
html_node(".list_news2")
length(html %>% html_node(".list_news2"))
html %>%
html_node(".list_news2") %>%
html_text("li")
html %>% html_node(".list_news2") %>% html_text("li")
html %>% html_node(".list_news2") %>% html_text("li") %>% trim()
html %>% html_node(".list_news2") %>% html_text("li") html_node("strong.tit_thumb") %>% html_text() %>% trim()
html %>% html_node(".list_news2") %>% html_text("li")
lis <- html %>% html_node(".list_news2") %>% html_text("li")
length(lis)
lis
rank <- c()
title <- c()
writer <- c()
rank <- c()
title <- c()
writer <- c()
for (li in lis) {
# 순위
rank <- li %>% trim() %>% str_sub(1,1)
# 제목
tmp <- li %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
title <- str_sub(tmp,1,idx[1]-1)
# 회사
tmp <- trim(str_sub(tmp,idx[1],-1))
writer <- tmp
}
html
url
lis <- html %>% html_node(".list_news2") %>% html_text("li")
rank <- c()
title <- c()
writer <- c()
for (li in lis) {
# 순위
rank <- c(rank ,li %>% trim() %>% str_sub(1,1))
# 제목
tmp <- li %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
title <- c(title,str_sub(tmp,1,idx[1]-1))
# 회사
tmp <- trim(str_sub(tmp,idx[1],-1))
writer <- c(writer,tmp)
}
lis[1]
html %>% html_node(".list_news2")
lis <- html %>% html_node(".list_news2")
lis <- html %>% html_node(".list_news2")
lis %>% trim() %>% str_sub(1,1)
lis <- html %>% html_node(".list_news2") %>% html_text("li")
lis
lis <- html %>% html_node(".list_news2") %>% html_nodes("li")
lis
li %>% trim() %>% str_sub(1,1)
li %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
lis %>% trim() %>% str_sub(1,1)
lis %>% trim()
lis
lis %>% html_node(".num_news num1")
lis %>% html_node(".screen_out")
lis %>% html_node(".screen_out") %>% html_text()
lis %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
tmp <- lis %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
idx
str_sub(tmp,1,idx[1]-1)
tmp <- trim(str_sub(tmp,idx[1],-1))
tmp
length(idx)
size(idx)
nrow(idx)
setwd("D:/Workplace/R_Project/project3_daum_ranking")
library(rvest)
library(dplyr)
library(stringr)
library(openxlsx)
library(abind)
base_url <- "https://media.daum.net/ranking/"
url_cat <- c("popular/","kkomkkom/","bestreply/","empathy/")
categories <- c("많이 본","열독률 높은","댓글 많은","실시간 공감")
daum_ranking <- data.frame(category=c(),rank=c(),title=c(),writer=c())
for (i in 1:length(url_cat)) {
url <- paste0(base_url,url_cat[i])
html <- read_html(url)
lis <- html %>% html_node(".list_news2") %>% html_nodes("li")
category <- c()
rank <- c()
title <- c()
writer <- c()
for (li in lis) {
# 순위
rank <- c(rank ,li %>% html_node(".screen_out") %>% html_text())
# 제목
tmp <- li %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
title <- c(title,str_sub(tmp,1,idx[1]-1))
# 회사
tmp <- trim(str_sub(tmp,idx[1],-1))
writer <- c(writer,tmp)
# 범주
category <- rep(categories[i],nrow(idx))
}
ranking <- data.frame(category=category,rank=rank,title=title,writer=writer)
daum_ranking <- rbind.data.frame(daum_ranking,ranking)
}
View(daum_ranking)
url <- "https://media.daum.net/ranking/kkomkkom/"
html <- read_html(url)
lis <- html %>% html_node(".list_news2") %>% html_nodes("li")
category <- c()
rank <- c()
title <- c()
writer <- c()
for (li in lis) {
# 순위
rank <- c(rank ,li %>% html_node(".screen_out") %>% html_text())
# 제목
tmp <- li %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
title <- c(title,str_sub(tmp,1,idx[1]-1))
# 회사
tmp <- trim(str_sub(tmp,idx[1],-1))
writer <- c(writer,tmp)
# 범주
category <- rep(categories[2],nrow(idx))
}
ranking <- data.frame(category=category,rank=rank,title=title,writer=writer)
ranking
lis
html
setwd("D:/Workplace/R_Project/project3_daum_ranking")
library(rvest)
library(dplyr)
library(stringr)
library(openxlsx)
library(abind)
### Daum ranking news
base_url <- "https://media.daum.net/ranking/"
url_cat <- c("popular",
"popular?include=society,politics,culture,economic,foreign,digital",
"popular?include=entertain",
"popular?include=sports",
"kkomkkom?include=news",
"kkomkkom?include=entertain",
"kkomkkom?include=sports",
"bestreply",
"bestreply?include=society,politics,culture,economic,foreign,digital",
"bestreply?include=entertain",
"bestreply?include=sports",
"empathy/")
categories <- c("많이 본(종합)","많이 본(뉴스)","많이 본(연예)","많이 본(스포츠)",
"열독률 높은(뉴스)","열독률 높은(연예)","열독률 높은(스포츠)",
"댓글 많은(종합)","댓글 많은(뉴스)","댓글 많은(연예)","댓글 많은(스포츠)",
"실시간 공감")
daum_ranking <- data.frame(category=c(),rank=c(),title=c(),writer=c())
for (i in 1:length(url_cat)) {
url <- paste0(base_url,url_cat[i])
html <- read_html(url)
lis <- html %>% html_node(".list_news2") %>% html_nodes("li")
category <- c()
rank <- c()
title <- c()
writer <- c()
for (li in lis) {
# 순위
rank <- c(rank ,li %>% html_node(".screen_out") %>% html_text())
# 제목
tmp <- li %>% html_node("strong.tit_thumb") %>% html_text() %>% trim()
idx <- str_locate(tmp,"\n")
title <- c(title,str_sub(tmp,1,idx[1]-1))
# 회사
tmp <- trim(str_sub(tmp,idx[1],-1))
writer <- c(writer,tmp)
# 범주
category <- rep(categories[i],nrow(idx))
}
ranking <- data.frame(category=category,rank=rank,title=title,writer=writer)
daum_ranking <- rbind.data.frame(daum_ranking,ranking)
}
View(daum_ranking)
write.csv(daum_ranking,"daum_ranking.csv")
