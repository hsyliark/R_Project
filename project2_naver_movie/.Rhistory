trim()
lis5 <- ifelse(lis5 %in% c("","동영상기사"),"",lis5)
lis6 <- html %>%
html_node('#main_content') %>%
html_node('.type06') %>%
html_nodes('.lede') %>%
html_text() %>%
trim()
lis6 <- ifelse(lis6 %in% c("","동영상기사"),"",lis6)
lis.articles <- c(lis5,lis6)
articles <- c()
for (i in 1:length(lis.articles)) {
if (lis.articles[i] %in% c("","동영상기사")) {
articles <- articles }
else {
a <- gsub('\\"',"",lis.articles[i])
articles <- c(articles,a)
}
}
headline <- data.frame(titles=titles, writing=writing, articles=articles)
naver_headline <- rbind.data.frame(naver_headline, headline)
#  addWorksheet(wb, categories[i])
#  writeDataTable(wb, categories[i], df_books)
}
# saveWorkbook(wb, file="D:/Workplace/R_Project/project1_naver_headline/naver_headline_top20.xlsx")
naver_headline <- cbind.data.frame(category,naver_headline)
View(naver_headline)
setwd("D:/Workplace/R_Project/project2_naver_movie")
library(rvest)
library(dplyr)
library(stringr)
library(openxlsx)
library(abind)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
base_url <- "https://movie.naver.com/movie/bi/mi/point.nhn?code=161967"
html <- read_html(base_url)
html %>%
html_node('iframe.ifr')
html %>%
html_node('iframe.ifr') %>%
html_attr('src')
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
url
url2 <- html %>%
html_node('iframe.ifr') %>%
html_attr('src')
url2
url_ifr <- paste0(base_url,url2)
url_ifr
html2 <- read_html(url2)
html2 <- read_html(url_ifr)
html2 %>%
html_node('.score_result')
html2 %>%
html_node('div.score_result')
html2 %>%
html_nodes('div.score_result')
html2 %>%
html_node('div.score_result') %>%
html-nodes('li')
tml2 %>%
html_node('div.score_result') %>%
html_nodes('li')
html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>%
html_attr('src')
url_ifr <- paste0(base_url,url2)
html2 <- read_html(url_ifr)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') %>%
trim()
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>%
html_attr('src')
url_ifr <- paste0(base_url,url2)
html2 <- read_html(url_ifr)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
str(lis)
lis[1]
View(lis)
View(lis)
lis
html2 %>% html_node('.star_score')
html2 %>% html_node('.star_score') %>% html_text('em')
html2 %>% html_node('.star_score') %>% html_text('em') %>% trim()
lis %>% html_node('.star_score') %>% html_text('em') %>% trim()
lis %>% html_node('.star_score')
lis %>% html_node('.star_score') %>% html_text('em')
lis %>% html_node('.star_score') %>% html_text('em') %>% trim()
# review
lis %>% html_node('.score_reple')
# review
lis %>% html_node('.score_reple') %>% html_text('p')
# review
lis %>% html_node('.score_reple') %>% html_text('p') %>% trim()
# review
tmp <- lis %>% html_node('.score_reple') %>% html_text('p') %>% trim()
str_locate(tmp,'\r')
idx <- str_locate(tmp,'\r')
idx[1]
idx[1,]
str_sub(tmp,1,idx[1]-1)
tmp
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
tmp
idx <- str_locate(tmp,'\r')
writer <- str_sub(tmp,1,idx[1]-1)
writer
tmp
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score') %>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple') %>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
naver_movie <- data.frame(score=score,review=review,writer=writer,time=time)
View(naver_movie)
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src')
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>%
html_attr('src')
url_ifr <- paste0(base_url,url2)
url_ifr
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>%
html_attr('src')
url_ifr <- paste0(base_url,url2)
url_add <- "&page="
pages < 1:2918
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>%
html_attr('src')
url_ifr <- paste0(base_url,url2)
url_add <- "&page="
pages <- 1:2918
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_ifr)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score') %>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple') %>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>%
html_attr('src')
url_ifr <- paste0(base_url,url2)
setwd("D:/Workplace/R_Project/project2_naver_movie")
library(rvest)
library(dplyr)
library(stringr)
library(openxlsx)
library(abind)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
### 영화 '기생충' 평점, 리뷰
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>% html_attr('src')
url_ifr <- paste0(base_url,url2)
url_add <- "&page="
pages <- 1:2918
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_ifr)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score')
%>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple')
%>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
### 영화 '기생충' 평점, 리뷰
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>% html_attr('src')
url_ifr <- paste0(base_url,url2)
url_add <- "&page="
pages <- 1:2918
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_ifr)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score')
%>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple')
%>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
### 영화 '기생충' 평점, 리뷰
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>% html_attr('src')
url_ifr <- paste0(base_url,url2)
url_add <- "&page="
pages <- 1:2918
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_ifr)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score')
%>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple')
%>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>% html_attr('src')
url_ifr <- paste0(base_url,url2)
url_add <- "&page="
pages <- 1:2918
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_pages)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score')
%>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple')
%>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
library(rvest)
library(dplyr)
library(stringr)
library(openxlsx)
library(abind)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
url <- paste0(base_url,url_sub)
html <- read_html(url)
url2 <- html %>%
html_node('iframe.ifr') %>% html_attr('src')
url_ifr <- paste0(base_url,url2)
url_add <- "&page="
pages <- 1:2918
url_ifr
naver_movie <- data.frame(score=c(),review=c(),writer=c(),time=c())
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_pages)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score')
%>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple')
%>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_pages)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score')
%>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple')
%>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
for (n in 1:length(pages)) {
url_pages <- paste0(url_ifr,url_add,pages[n])
html2 <- read_html(url_pages)
lis <- html2 %>%
html_node('div.score_result') %>%
html_nodes('li')
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
# score
score <- c(score,li %>% html_node('.star_score')
%>% html_text('em') %>% trim())
# review
tmp <- li %>% html_node('.score_reple')
%>% html_text('p') %>% trim()
idx <- str_locate(tmp,'\r')
review <- c(review,str_sub(tmp,1,idx[1]-1))
# writer
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
writer <- c(writer,str_sub(tmp,1,idx[1]-1))
# time
tmp <- trim(str_sub(tmp,idx[1],-1))
idx <- str_locate(tmp,'\r')
time <- c(time,str_sub(tmp,1,idx[1]-1))
}
movie <- data.frame(score=score,review=review,writer=writer,time=time)
naver_movie <- rbind.data.frame(naver_movie,movie)
}
base_url <- "https://movie.naver.com"
url_sub <- "/movie/bi/mi/point.nhn?code=161967"
